<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Global Hire Assist — Your Trusted Visa Partner</title>

<!-- PayPal SDK (sandbox client-id=sb). Replace client-id with your production key later. -->
<script src="https://www.paypal.com/sdk/js?client-id=sb&components=buttons,funding-eligibility"></script>

<style>
  :root{
    --navy:#001f3f;
    --accent:#0ea5a5;
    --card-bg:#0b1220;
    --muted:#bfc6d1;
    --white:#ffffff;
  }
  html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;}
  body{
    background: linear-gradient(180deg,var(--navy) 0%, #021427 100%);
    color:var(--muted);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }
  header{
    background:#000;
    color:var(--white);
    padding:14px 18px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    box-shadow: 0 2px 10px rgba(0,0,0,0.4);
    position:sticky; top:0; z-index:40;
  }
  header .brand{display:flex;gap:12px;align-items:center}
  .logo{
    width:58px;height:58px;border-radius:8px;background:linear-gradient(135deg,var(--accent),#0b84a5);
    display:flex;align-items:center;justify-content:center;font-weight:700;color:#001f3f;
    font-size:18px;
  }
  nav a{color:var(--muted);text-decoration:none;margin-left:12px}
  .container{max-width:1100px;margin:36px auto;padding:0 18px;}
  .hero{
    display:grid;grid-template-columns: 1fr 420px;gap:28px;align-items:center;
    margin-bottom:28px;
  }
  .hero-card{
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    padding:26px;border-radius:12px;box-shadow: 0 8px 30px rgba(0,0,0,0.5);
    color:var(--white);
  }
  h1{margin:0 0 8px 0;font-size:28px;color:var(--white);}
  p.lead{margin:0;color:var(--muted);line-height:1.5}
  .cta{margin-top:16px}
  .btn{
    display:inline-block;padding:10px 16px;border-radius:10px;background:var(--accent);
    color:#001f3f;text-decoration:none;font-weight:700;cursor:pointer;border:none;
  }
  .services{display:flex;gap:12px;margin-top:18px;flex-wrap:wrap}
  .service{background:#031b2a;padding:12px;border-radius:10px;min-width:140px;text-align:center}
  .small{font-size:13px;color:var(--muted);}
  /* form styles */
  .card{background:var(--card-bg);padding:18px;border-radius:12px;color:var(--muted);box-shadow:0 6px 25px rgba(0,0,0,0.5)}
  form .row{display:flex;gap:10px}
  label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
  input[type="text"], input[type="email"], input[type="tel"], select, textarea{
    width:100%;padding:10px;border-radius:8px;border:none;background:#071126;color:var(--muted);
    box-sizing:border-box;font-size:14px;
  }
  textarea{min-height:110px;resize:vertical}
  .file-input{padding:8px;background:#071126;border-radius:8px}
  .muted-note{font-size:12px;color:#9fb0bd;margin-top:6px;}
  .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .testimonials{display:flex;gap:12px;margin-top:18px;flex-wrap:wrap}
  .t{background:#071528;padding:12px;border-radius:8px;min-width:180px}
  footer{background:#000;padding:18px;color:var(--muted);margin-top:28px;border-top:1px solid #071018;}
  .whatsapp{
    position:fixed;right:18px;bottom:18px;background:#25d366;color:#001b15;border-radius:50%;width:60px;height:60px;
    display:flex;align-items:center;justify-content:center;font-size:22px;box-shadow:0 6px 20px rgba(0,0,0,0.4);z-index:60;
  }
  /* admin modal / dashboard */
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.6);z-index:80}
  .modal.active{display:flex}
  .modal-card{width:920px;max-width:96%;background:#05111a;padding:18px;border-radius:12px;color:var(--muted)}
  .admin-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
  table{width:100%;border-collapse:collapse;color:var(--muted);font-size:13px}
  th,td{padding:8px;border-bottom:1px dashed #072129;text-align:left}
  .status-btn{padding:6px 8px;border-radius:10px;border:none;cursor:pointer;background:#09323b;color:var(--muted)}
  .status-select{padding:8px;border-radius:8px;background:#071126;border:none;color:var(--muted)}
  .btn-ghost{background:transparent;border:1px solid #0b2b33;color:var(--muted);padding:8px 10px;border-radius:8px}
  .admin-actions{display:flex;gap:8px;flex-wrap:wrap}
  .export{margin-top:12px}
  /* responsive */
  @media (max-width:920px){
    .hero{grid-template-columns:1fr}
  }
</style>
</head>
<body>

<header>
  <div class="brand">
    <div class="logo">GHA</div>
    <div>
      <div style="font-weight:700;color:var(--white)">Global Hire Assist</div>
      <div style="font-size:12px;color:var(--muted)">Your Trusted Visa Partner</div>
    </div>
  </div>

  <nav>
    <a href="#services">Services</a>
    <a href="#apply" class="start-application">Start Application</a>
    <a href="#payments">Pay for Visa</a>
    <a href="#" id="open-admin">Consultant Panel</a>
  </nav>
</header>

<!-- WhatsApp floating button -->
<a class="whatsapp" id="whatsappBtn" title="Chat on WhatsApp" href="https://wa.me/14472763403?text=Hello%20Global%20Hire%20Assist" target="_blank" rel="noopener noreferrer">
  <!-- WhatsApp icon (simple) -->
  <svg width="22" height="22" viewBox="0 0 24 24" fill="none" style="display:block">
    <path d="M20.52 3.48A11.93 11.93 0 0 0 12 0C5.372 0 .001 5.372 0 12c0 2.11.558 4.18 1.62 6.03L0 24l6.23-1.63A11.94 11.94 0 0 0 12 24c6.628 0 12-5.372 12-12 0-3.2-1.25-6.19-3.48-8.52Z" fill="#fff" opacity="0.08"/>
    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.966-.273-.099-.472-.149-.672.149-.198.297-.767.966-.94 1.164-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.477-.885-.79-1.48-1.763-1.653-2.06-.173-.297-.018-.458.13-.606.133-.132.297-.347.446-.52.149-.173.198-.298.297-.497.099-.198.05-.372-.025-.52-.074-.149-.672-1.62-.92-2.22-.242-.584-.487-.504-.672-.513l-.57-.01c-.198 0-.52.074-.792.372-.273.297-1.04 1.015-1.04 2.47 0 1.456 1.064 2.868 1.213 3.069.149.198 2.095 3.2 5.077 4.487 2.982 1.286 2.982.858 3.518.804.536-.055 1.758-.718 2.006-1.411.248-.692.248-1.286.173-1.411-.074-.124-.272-.198-.57-.347Z" fill="#25D366"/>
  </svg>
</a>

<main class="container">
  <section class="hero" aria-label="hero">
    <div class="hero-card card">
      <h1>Fast, Reliable Visa Help</h1>
      <p class="lead">Global Hire Assist helps you navigate Work, Study, Tourist visas and Sponsorships. Start your application now and our consultants will walk you through the next steps.</p>

      <div class="services" id="services">
        <div class="service"><strong>Work Visa</strong><div class="small">Skilled & employer-sponsored</div></div>
        <div class="service"><strong>Study Visa</strong><div class="small">Student & university guidance</div></div>
        <div class="service"><strong>Tourist Visa</strong><div class="small">Quick & easy processing</div></div>
        <div class="service"><strong>Sponsorships</strong><div class="small">Family & employer sponsorship</div></div>
      </div>

      <div style="margin-top:18px;display:flex;gap:8px;align-items:center">
        <button class="btn start-application" onclick="document.getElementById('applyForm').scrollIntoView({behavior:'smooth'})">Start Application</button>
        <a class="btn-ghost" href="#payments" style="color:var(--muted)">Pay for Visa</a>
      </div>

      <div style="margin-top:14px">
        <div class="small">Trusted by applicants worldwide</div>
        <div class="testimonials" style="margin-top:10px">
          <div class="t">"Excellent guidance — got my work visa in weeks." — A. M.</div>
          <div class="t">"Professional and transparent." — N. K.</div>
          <div class="t">"Saved me time & money." — S. R.</div>
        </div>
      </div>
    </div>

    <!-- Right column: 4K travel image carousel -->
    <div class="card" style="padding:8px;border-radius:12px;">
      <div id="carousel" style="border-radius:8px;overflow:hidden;position:relative">
        <!-- 4k images from Unsplash (free to use). Replace with your own 4K images in production -->
        <img src="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?q=80&w=2560&fm=jpg&crop=entropy&cs=tinysrgb" alt="Travel 1" style="width:100%;height:320px;object-fit:cover;display:block" id="carouselImg">
        <div style="position:absolute;left:14px;bottom:14px;background:rgba(0,0,0,0.45);padding:8px;border-radius:8px">
          <div style="font-weight:700;color:#fff">Dream. Apply. Travel.</div>
          <div style="font-size:12px;color:#d6e6ea">High-resolution travel inspiration</div>
        </div>
      </div>
      <div style="display:flex;gap:8px;margin-top:8px;justify-content:center">
        <button class="btn-ghost" onclick="prevImage()">Prev</button>
        <button class="btn-ghost" onclick="nextImage()">Next</button>
      </div>
    </div>
  </section>

  <!-- Application Form -->
  <section class="card" id="applyForm" style="margin-bottom:18px">
    <h3 style="color:var(--white)">Visa Application Form</h3>
    <p class="small">Fill the form below — you'll receive a reference number immediately.</p>

    <form id="visaForm" onsubmit="handleSubmit(event)">
      <div class="grid-2" style="margin-top:12px">
        <div>
          <label for="name">Full Name</label>
          <input id="name" required type="text" placeholder="Jane Doe" />
        </div>
        <div>
          <label for="email">Email</label>
          <input id="email" required type="email" placeholder="you@example.com" />
        </div>
      </div>

      <div class="grid-2" style="margin-top:12px">
        <div>
          <label for="phone">Phone</label>
          <input id="phone" required type="tel" placeholder="+1 555 555 5555" />
        </div>
        <div>
          <label for="residence">Country of Residence</label>
          <input id="residence" required type="text" placeholder="Country" />
        </div>
      </div>

      <div class="grid-2" style="margin-top:12px">
        <div>
          <label for="destination">Destination Country</label>
          <input id="destination" required type="text" placeholder="Destination Country" />
        </div>
        <div>
          <label for="visaType">Visa Type</label>
          <select id="visaType" required>
            <option value="">-- Select --</option>
            <option>Work Visa</option>
            <option>Study Visa</option>
            <option>Tourist Visa</option>
            <option>Sponsorship</option>
            <option>Other</option>
          </select>
        </div>
      </div>

      <div style="margin-top:12px">
        <label for="message">Message / Additional Info</label>
        <textarea id="message" placeholder="Tell us about your case"></textarea>
      </div>

      <div style="margin-top:12px">
        <label>Upload passport or supporting documents (PDF, JPG, PNG)</label>
        <div class="file-input">
          <input id="fileUpload" type="file" accept=".pdf,image/*" />
        </div>
        <div class="muted-note">Max file size in this demo is not enforced; to store files long-term use a server or cloud storage (S3/Google Drive).</div>
      </div>

      <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
        <button class="btn" type="submit">Submit Application</button>
        <div id="refBox" style="font-size:13px;color:var(--muted)"></div>
      </div>
    </form>
  </section>

  <!-- Payment Section -->
  <section class="card" id="payments" style="margin-bottom:18px">
    <h3 style="color:var(--white)">Pay for Visa</h3>
    <p class="small">Choose PayPal checkout to pay with PayPal, debit/credit cards (Visa, Mastercard). Or follow manual payment instructions for Western Union.</p>

    <div style="display:flex;gap:20px;flex-wrap:wrap;margin-top:12px;align-items:flex-start">
      <div style="min-width:320px;flex:1">
        <div style="background:#071826;padding:12px;border-radius:10px">
          <h4 style="margin:0;color:var(--white)">Pay via PayPal (Sandbox)</h4>
          <div id="paypal-button-container" style="margin-top:12px"></div>
          <div class="small muted-note">PayPal sandbox is enabled for demo. Replace the PayPal client-id with your account key in production.</div>
        </div>
      </div>

      <div style="min-width:320px;flex:1">
        <div style="background:#071826;padding:12px;border-radius:10px">
          <h4 style="margin:0;color:var(--white)">Manual Payments</h4>
          <div style="margin-top:8px">
            <strong>Western Union</strong>
            <div class="small">Send to: Global Hire Assist — Name: Global Hire Assist. Please message us the MTCN code and payer name to <a href="mailto:henywilliams@myyahoo.com" style="color:var(--accent)">henywilliams@myyahoo.com</a>.</div>
          </div>
          <div style="margin-top:8px">
            <strong>Direct bank / Card</strong>
            <div class="small">We accept debit/credit via PayPal card checkout above.</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Quick contact / Chat -->
  <section class="card" style="margin-bottom:18px">
    <h3 style="color:var(--white)">Quick Contact</h3>
    <p class="small">Got a quick question? Message us and get an auto-reply.</p>

    <form id="contactForm" onsubmit="handleContact(event)" style="margin-top:10px">
      <div class="grid-2">
        <div>
          <label for="cname">Name</label>
          <input id="cname" required type="text" />
        </div>
        <div>
          <label for="cphone">Phone</label>
          <input id="cphone" type="tel" />
        </div>
      </div>
      <div style="margin-top:10px">
        <label for="cmsg">Message</label>
        <textarea id="cmsg" placeholder="Your question"></textarea>
      </div>
      <div style="margin-top:10px;display:flex;gap:8px;align-items:center">
        <button class="btn" type="submit">Send Message</button>
        <a class="btn" href="https://wa.me/14472763403?text=Hello%20Global%20Hire%20Assist" style="background:#25D366">WhatsApp</a>
      </div>
    </form>
  </section>

  <footer>
    <div style="max-width:1100px;margin:0 auto;display:flex;justify-content:space-between;flex-wrap:wrap;gap:12px">
      <div>
        <div style="font-weight:700;color:var(--white)">Global Hire Assist</div>
        <div class="small">Your Trusted Visa Partner — Email: <a href="mailto:henywilliams@myyahoo.com" style="color:var(--muted)">henywilliams@myyahoo.com</a></div>
      </div>
      <div class="small">© <span id="yr"></span> Global Hire Assist — All rights reserved.</div>
    </div>
  </footer>
</main>

<!-- Admin modal (Consultant Panel) -->
<div class="modal" id="adminModal" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="modal-card">
    <div class="admin-head">
      <div>
        <div style="font-weight:700;color:var(--white)">Consultant Panel</div>
        <div class="small">Admin: henywilliams@myyahoo.com</div>
      </div>
      <div>
        <button class="btn-ghost" id="closeAdmin">Close</button>
      </div>
    </div>

    <div id="adminLoginArea">
      <p class="small">Please login with your admin password to view applications.</p>
      <div style="display:flex;gap:8px;align-items:center">
        <input id="adminEmail" type="text" readonly value="henywilliams@myyahoo.com" style="padding:8px;border-radius:8px;border:none;background:#071126;color:var(--muted)" />
        <input id="adminPassword" type="password" placeholder="Admin password" style="padding:8px;border-radius:8px;border:none;background:#071126;color:var(--muted)" />
        <button class="btn" id="adminLoginBtn">Login</button>
      </div>
      <div id="adminMsg" style="margin-top:8px;color:#f88;font-size:13px"></div>
    </div>

    <div id="dashboardArea" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div class="small">Logged in as: <strong style="color:var(--white)">henywilliams@myyahoo.com</strong></div>
        <div class="admin-actions">
          <button class="btn-ghost" id="exportCsv">Export CSV</button>
          <button class="btn-ghost" id="logoutBtn">Logout</button>
        </div>
      </div>

      <div style="margin-top:12px;overflow:auto;max-height:440px">
        <table id="appsTable" role="grid">
          <thead>
            <tr><th>Ref</th><th>Name</th><th>Email</th><th>Phone</th><th>Destination</th><th>Visa Type</th><th>Status</th><th>Actions</th></tr>
          </thead>
          <tbody id="appsTbody"></tbody>
        </table>
      </div>

    </div>
  </div>
</div>

<script>
/* ---------- Configuration / constants (change for production) ---------- */
const ADMIN_EMAIL = 'henywilliams@myyahoo.com';
const ADMIN_PASSWORD = '40318055'; // as requested (INSECURE to store client-side in production)
const WHATSAPP_NUMBER = '+14472763403';

/* ---------- Page helpers ---------- */
document.getElementById('yr').textContent = new Date().getFullYear();

/* Carousel images (4K ready). Replace URLs with your own images if you have them */
const images = [
  "https://images.unsplash.com/photo-1507525428034-b723cf961d3e?q=80&w=2560&fm=jpg&crop=entropy&cs=tinysrgb",
  "https://images.unsplash.com/photo-1501785888041-af3ef285b470?q=80&w=2560&fm=jpg&crop=entropy&cs=tinysrgb",
  "https://images.unsplash.com/photo-1467269204594-9661b134dd2b?q=80&w=2560&fm=jpg&crop=entropy&cs=tinysrgb"
];
let carouselIndex = 0;
const carouselImg = document.getElementById('carouselImg');
function nextImage(){ carouselIndex=(carouselIndex+1)%images.length; carouselImg.src=images[carouselIndex]; }
function prevImage(){ carouselIndex=(carouselIndex-1+images.length)%images.length; carouselImg.src=images[carouselIndex]; }
setInterval(nextImage,7000);

/* ---------- Form handling (stores to localStorage in this demo) ---------- */
function generateRef(){
  const t = new Date();
  const pad = (n)=>String(n).padStart(2,'0');
  const dt = `${t.getFullYear()}${pad(t.getMonth()+1)}${pad(t.getDate())}${pad(t.getHours())}${pad(t.getMinutes())}${pad(t.getSeconds())}`;
  const rand = Math.floor(1000 + Math.random()*9000);
  return `GHA-${dt}-${rand}`;
}

function saveApplication(app){
  const key = 'gha_applications_v1';
  const existing = JSON.parse(localStorage.getItem(key) || '[]');
  existing.unshift(app);
  localStorage.setItem(key, JSON.stringify(existing));
}

/* optional: POST to Google Apps Script / Google Sheet:
   Replace 'YOUR_GOOGLE_APPS_SCRIPT_URL' with your Apps Script endpoint to push data to Google Sheets.
   Example:
   fetch('YOUR_GOOGLE_APPS_SCRIPT_URL', {method:'POST', body: JSON.stringify(app)})
*/
async function handleSubmit(e){
  e.preventDefault();
  const app = {
    ref: generateRef(),
    name: document.getElementById('name').value.trim(),
    email: document.getElementById('email').value.trim(),
    phone: document.getElementById('phone').value.trim(),
    residence: document.getElementById('residence').value.trim(),
    destination: document.getElementById('destination').value.trim(),
    visaType: document.getElementById('visaType').value,
    message: document.getElementById('message').value.trim(),
    status: 'Pending',
    createdAt: new Date().toISOString()
  };

  // handle file (store as dataURL small demo)
  const f = document.getElementById('fileUpload').files[0];
  if(f){
    const maxSizeMB = 10;
    if(f.size > maxSizeMB*1024*1024){
      alert('File too large for demo. Use a server/cloud for large files.');
      return;
    }
    app.fileName = f.name;
    app.fileType = f.type;
    app.fileData = await fileToDataURL(f);
  }

  saveApplication(app);
  // show ref to user
  document.getElementById('refBox').innerHTML = `<strong>Reference:</strong> ${app.ref} — we will contact you at ${app.email || app.phone}`;
  // auto-reply email (mailto) and auto WhatsApp prefill (client-side only)
  // Optionally you can call server/email service here.
  setTimeout(()=>document.getElementById('refBox').scrollIntoView({behavior:'smooth'}),250);

  // reset form (except file)
  document.getElementById('visaForm').reset();
  // update admin table if open
  renderAdminTable();
}

/* helper to read files to dataURL */
function fileToDataURL(file){
  return new Promise((res,rej)=>{
    const r = new FileReader();
    r.onload = ()=>res(r.result);
    r.onerror = rej;
    r.readAsDataURL(file);
  });
}

/* Contact quick form (auto-reply behavior) */
function handleContact(e){
  e.preventDefault();
  const name = document.getElementById('cname').value.trim();
  const phone = document.getElementById('cphone').value.trim();
  const msg = document.getElementById('cmsg').value.trim();
  // Auto reply: either email or WhatsApp
  alert("Thank you for contacting Global Hire Assist. Our agent will reach out shortly.");
  // Optionally open WhatsApp for the admin
  const waLink = `https://wa.me/${WHATSAPP_NUMBER.replace(/\D/g,'')}?text=${encodeURIComponent(`New contact from ${name} (${phone}): ${msg}`)}`;
  // open in new tab (commented out: admin may prefer to receive this)
  // window.open(waLink,'_blank');
  document.getElementById('contactForm').reset();
}

/* ---------- Admin panel ---------- */
const adminModal = document.getElementById('adminModal');
document.getElementById('open-admin').addEventListener('click', (ev)=>{ ev.preventDefault(); openAdmin(); });
document.getElementById('closeAdmin').addEventListener('click', ()=>{ adminModal.classList.remove('active'); });
function openAdmin(){ adminModal.classList.add('active'); document.getElementById('adminPassword').value=''; document.getElementById('adminMsg').textContent=''; showLogin(); }

function showLogin(){document.getElementById('adminLoginArea').style.display='block'; document.getElementById('dashboardArea').style.display='none'; document.getElementById('adminModal').setAttribute('aria-hidden','false');}

function showDashboard(){document.getElementById('adminLoginArea').style.display='none'; document.getElementById('dashboardArea').style.display='block'; document.getElementById('adminModal').setAttribute('aria-hidden','false'); renderAdminTable();}

document.getElementById('adminLoginBtn').addEventListener('click', ()=>{
  const pass = document.getElementById('adminPassword').value;
  const email = document.getElementById('adminEmail').value;
  if(email !== ADMIN_EMAIL){
    document.getElementById('adminMsg').textContent = 'Incorrect admin email.';
    return;
  }
  if(pass === ADMIN_PASSWORD){
    document.getElementById('adminMsg').textContent = '';
    showDashboard();
  } else {
    document.getElementById('adminMsg').textContent = 'Invalid password.';
  }
});
document.getElementById('logoutBtn').addEventListener('click', showLogin);

function getApplications(){
  return JSON.parse(localStorage.getItem('gha_applications_v1') || '[]');
}

function renderAdminTable(){
  const apps = getApplications();
  const tbody = document.getElementById('appsTbody');
  tbody.innerHTML = '';
  if(!apps.length){
    tbody.innerHTML = '<tr><td colspan="8" style="padding:12px;color:#9fb0bd">No applications yet.</td></tr>';
    return;
  }
  for(const a of apps){
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td style="width:115px">${a.ref}</td>
      <td>${a.name||''}</td>
      <td><a href="mailto:${a.email}" style="color:var(--accent)">${a.email||''}</a></td>
      <td>${a.phone||''}</td>
      <td>${a.destination||''}</td>
      <td>${a.visaType||''}</td>
      <td>
        <select class="status-select" data-ref="${a.ref}">
          <option ${a.status==='Pending'?'selected':''}>Pending</option>
          <option ${a.status==='Under Review'?'selected':''}>Under Review</option>
          <option ${a.status==='In Process'?'selected':''}>In Process</option>
          <option ${a.status==='Approved'?'selected':''}>Approved</option>
          <option ${a.status==='Rejected'?'selected':''}>Rejected</option>
        </select>
      </td>
      <td>
        <div style="display:flex;gap:6px;flex-wrap:wrap">
          <button class="status-btn" data-action="email" data-ref="${a.ref}">Email</button>
          <button class="status-btn" data-action="whatsapp" data-ref="${a.ref}">WhatsApp</button>
          <button class="status-btn" data-action="view" data-ref="${a.ref}">View</button>
        </div>
      </td>
    `;
    tbody.appendChild(tr);
  }

  // attach change listeners
  document.querySelectorAll('.status-select').forEach(sel=>{
    sel.onchange = function(){
      const ref = this.dataset.ref;
      const val = this.value;
      updateStatus(ref,val);
    }
  });

  document.querySelectorAll('.status-btn').forEach(btn=>{
    btn.onclick = function(){
      const ref = this.dataset.ref;
      const action = this.dataset.action;
      const app = getApplications().find(x=>x.ref===ref);
      if(!app) return alert('Application not found.');
      if(action==='email'){
        // open mailto with prefilled content
        const subj = encodeURIComponent(`Update on your application ${ref}`);
        const body = encodeURIComponent(`Hello ${app.name || ''},\n\nThis is an update on your application (${ref}). Current status: ${app.status}\n\nRegards,\nGlobal Hire Assist\n`);
        window.location.href = `mailto:${app.email}?subject=${subj}&body=${body}`;
      } else if(action==='whatsapp'){
        const waNum = '${WHATSAPP_NUMBER}';
        const msg = encodeURIComponent(`Hello ${app.name || ''}, this is an update on your application ${ref}. Current status: ${app.status}.`);
        window.open(`https://wa.me/${WHATSAPP_NUMBER.replace(/\D/g,'')}?text=${msg}`, '_blank');
      } else if(action==='view'){
        viewApplicationDetail(app);
      }
    };
  });
}

function updateStatus(ref, newStatus){
  const apps = getApplications();
  const idx = apps.findIndex(x=>x.ref===ref);
  if(idx===-1) return;
  apps[idx].status = newStatus;
  localStorage.setItem('gha_applications_v1', JSON.stringify(apps));
  renderAdminTable();
}

/* View single application detail in alert (demo). You can expand this to show a modal with attachments. */
function viewApplicationDetail(app){
  const s = `
Reference: ${app.ref}
Name: ${app.name}
Email: ${app.email}
Phone: ${app.phone}
Residence: ${app.residence}
Destination: ${app.destination}
Visa Type: ${app.visaType}
Status: ${app.status}
Message: ${app.message || '(none)'}
Created: ${app.createdAt}
File: ${app.fileName || '(none)'}
  `;
  alert(s);
}

/* Export CSV */
document.getElementById('exportCsv').addEventListener('click', ()=>{
  const apps = getApplications();
  if(!apps.length) return alert('No submissions to export.');
  const headers = ['ref','name','email','phone','residence','destination','visaType','message','status','createdAt','fileName'];
  const rows = apps.map(a=>headers.map(h=>`"${(a[h]||'').toString().replace(/"/g,'""')}"`).join(','));
  const csv = [headers.join(','), ...rows].join('\n');
  const blob = new Blob([csv], {type:'text/csv'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = 'gha_applications.csv'; a.click();
  URL.revokeObjectURL(url);
});

/* Simple export button on page load to render admin table if admin is already logged in */
function tryRenderIfOpen(){
  if(document.getElementById('dashboardArea').style.display === 'block'){
    renderAdminTable();
  }
}
setInterval(tryRenderIfOpen,2000);

/* ---------- PayPal Buttons (client-side) ---------- */
if(window.paypal){
  paypal.Buttons({
    style: {layout:'vertical', color:'blue', shape:'rect', label:'paypal'},
    createOrder: function(data, actions){
      return actions.order.create({
        purchase_units: [{
          amount: {value: '50.00'},
          description: 'Visa Processing Fee - Sample'
        }]
      });
    },
    onApprove: function(data, actions){
      return actions.order.capture().then(function(details){
        alert('Payment completed by ' + details.payer.name.given_name + '. Mark the case as In Process in admin panel.');
        // In a real app, you would forward payment details to your server and mark the relevant application.
      });
    },
    onError: function(err){ console.error(err); alert('PayPal error: ' + err); }
  }).render('#paypal-button-container');
}

/* ---------- small utilities ---------- */
document.getElementById('open-admin').addEventListener('click', (e)=>e.preventDefault());
document.getElementById('whatsappBtn').addEventListener('click', ()=>{}); // link already set

/* Render admin table on load if modal open */
renderAdminTable();
</script>
</body>
</html>